# Unstallation instructions for Windows/WSL

This installation runs Docker on WSL Ubuntu and builds the application in the WSL/Ubuntu space.  Setup of python and other tooling in Linux is much easier and compartmentalizes the dev environment from the main windows space.

Coding takes place in VSCode with the WSL extension which allows for attaching VSCode to the Ubuntu WSL instance.

**WORK IN PROGRESS**

## WSL Mirrored networking mode
WSL should be setup in Mirror networking mode or connections will misbehave or refuse to route when a VPN is active (e.g. DFA).  This mode will mirror (most) of the host network interfaces into the WSL space.  

On windows, in your home directory, create a file ".wslconfig" and put the following in as contents:

[wsl2]
networkingMode=mirrored

Note: It will mean that you can't run services in both Windows and Linux with the same port (e.g. 8080) since both spaces see localhost as the same IP. 


## Ubuntu configuration
Create a /bin/vpn-dns.sh with exec privileges containing the following:

#!/bin/bash

echo "Getting current DNS servers, this takes a couple of seconds"

/mnt/c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -Command '
$ErrorActionPreference="SilentlyContinue"
Get-NetAdapter -InterfaceDescription "Cisco AnyConnect*" | Get-DnsClientServerAddress | Select -ExpandProperty ServerAddresses
Get-NetAdapter | ?{-not ($_.InterfaceDescription -like "Cisco AnyConnect*") } | Get-DnsClientServerAddress | Select -ExpandProperty ServerAddresses
' | \
        awk 'BEGIN { print "# Generated by vpn fix func on", strftime("%c"); print } { print "nameserver", $1 }' | \
        tr -d '\r' > /etc/resolv.conf
clear

# Update ~/.bashrc
Install chromium in Ubuntu

Add this:
export BROWSER=/snap/bin/chromium

## paperglass api
Necessary to monkey patch the paperglass-api container to insert the following into /etc/resolv.conf to ensure name resolution and routing to qa.kinnser.net:
echo "nameserver 100.126.51.1" >> /etc/resolv.conf
